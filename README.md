# Bank API Service

## О проекте

**Bank API Service** — это RESTful API-сервис, эмулирующий базовую банковскую систему. Он предоставляет эндпоинты для управления пользователями, счетами, проведением транзакций, конвертацией валют и получением сводной информации о балансе.

Проект построен на стеке Spring Boot и использует MariaDB в качестве базы данных, с Hibernate (JPA) для ORM.

## Технологический стек

* **Java 17**
* **Spring Boot 3.x**
  * Spring Web (RESTful API)
  * Spring Data JPA (Hibernate)
  * Spring Validation
* **MariaDB** (База данных)
* **Lombok** (Сокращение boilerplate-кода)
* **Gradle (KTS)** (Система сборки)

## Основные возможности

* **Управление счетами**: Создание счетов в трех валютах (USD, EUR, UAH).
* **Пополнение счета**: Внесение средств на любой счет.
* **Перевод средств**: Перевод средств между любыми двумя счетами с автоматической конвертацией, если валюты не совпадают.
* **Конвертация валюты**: Перевод средств между счетами *одного* пользователя с явным указанием конвертации.
* **Агрегация баланса**: Получение суммарного баланса пользователя в эквиваленте UAH, рассчитанного по текущим курсам.
* **Логирование транзакций**: Все операции (пополнение, перевод, конвертация) фиксируются в таблице `transactions`.

## Структура Базы Данных

Hibernate автоматически генерирует следующую схему на основе Entities:

1.  **`users`**: Хранит информацию о пользователях.
2.  **`accounts`**: Хранит информацию о счетах, привязанных к пользователям. Каждый счет имеет баланс и одну из трех валют (`USD`, `EUR`, `UAH`).
3.  **`transactions`**: Журнал всех финансовых операций (DEPOSIT, TRANSFER, CONVERSION).
4.  **`exchange_rates`**: Таблица для хранения курсов валют по отношению к UAH. (Например, `USD_rateToUah = 39.50`).

## API Эндпоинты

Все эндпоинты доступны по базовому пути `/api/v1/bank`.

| Метод | URL | Описание | Тело запроса (JSON) |
| :--- | :--- | :--- | :--- |
| `POST` | `/deposit` | Пополнение счета. | `{"accountNumber": "...", "amount": ...}` |
| `POST` | `/transfer` | Перевод средств между двумя любыми счетами. | `{"fromAccountNumber": "...", "toAccountNumber": "...", "amount": ...}` |
| `POST` | `/users/{userId}/convert` | Конвертация валюты между счетами одного пользователя. | `{"fromAccountNumber": "...", "toAccountNumber": "...", "amount": ...}` |
| `GET` | `/users/{userId}/total-balance` | Получение общего баланса пользователя в UAH. | (Нет) |

## Установка и запуск

1.  **Клонируйте репозиторий:**
    ```bash
    git clone https://github.com/Kitty-Hivens/Bank-API-Spring.git
    cd Bank-API-Spring
    ```

2.  **Настройте базу данных:**
    * Убедитесь, что у вас установлен и запущен сервер MariaDB.
    * Откройте `src/main/resources/application.properties`.
    * Измените следующие параметры в соответствии с вашими настройками MariaDB:
        ```properties
        spring.datasource.url=jdbc:mariadb://localhost:3306/bank_db?createDatabaseIfNotExist=true
        spring.datasource.username=ваш_пользователь
        spring.datasource.password=ваш_пароль
        ```
    * При первом запуске (`spring.jpa.hibernate.ddl-auto=update`) Hibernate автоматически создаст базу данных `bank_db` и все необходимые таблицы.

3.  **Запустите приложение:**
    ```bash
    ./gradlew bootRun
    ```
    Или запустите `BankApplication.java` из вашей IDE.

4.  **Тестирование:**
    * Сервис будет доступен по адресу `http://localhost:8080`.
    * При первом запуске класс `DataInitializer` создаст тестовые курсы валют и двух пользователей с полным набором счетов (UAH, USD, EUR) для демонстрации работы API.
